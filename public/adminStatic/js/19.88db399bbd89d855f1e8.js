webpackJsonp([19],{Da1G:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={props:{teacherInfo:Object},data:function(){return{formData:{time_site:[{}]},subjectCatalog:null,faculty:null,facultyCatalog:null,major:null,majorCatalog:null,gradeCatalog:null}},methods:{handleSubmit:function(){var t=this;if(this.formData.course_name&&this.formData.grade&&this.formData.time_site[0].day&&this.formData.time_site[0].node&&this.formData.time_site[0].classroom){var e=[];this.formData.time_site.forEach(function(t,a){t.day&&t.node&&t.classroom&&e.push(t)}),this.formData.time_site=e,this.formData.teacher=this.teacherInfo._id,this.$axios.post("/course",this.formData).then(function(e){0==e.code?(t.$message.success(e.msg),setTimeout(function(){t.$router.push("/layout/courseList")},500)):t.$message(e.msg)})}else this.$message("请输入必填项")},getdata:function(){var t=this,e=this.$route.params.id;this.$axios.get("/course/"+e).then(function(e){t.formData=e.data,t.gradeCatalog=[e.data.grade],t.formData.grade=e.data.grade._id})},handlerevise:function(){var t=this,e=this.$route.params.id,a=[];this.formData.time_site.forEach(function(t,e){t.day&&t.node&&t.classroom&&a.push(t)}),this.formData.time_site=a,this.$axios.put("/course/"+e,this.formData).then(function(e){0==e.code?(t.$message.success(e.msg),setTimeout(function(){t.$router.push("/layout/courseList")},500)):t.$message(e.msg)})},getSubject:function(){var t=this;this.$axios.get("/subject").then(function(e){t.subjectCatalog=e.data})},handleFaculty:function(){var t=this;this.$axios.get("/faculty").then(function(e){0==e.code&&(t.facultyCatalog=e.data)})},handleMajor:function(t){var e=this;this.$axios.get("/major/faculty/"+t).then(function(t){0==t.code&&(e.majorCatalog=t.data)})},handleGrade:function(t){var e=this;this.$axios.get("/grade/major/"+t).then(function(t){0==t.code&&(e.gradeCatalog=t.data)})},handelAddTime:function(){this.formData.time_site.push({})}},mounted:function(){this.getSubject(),this.handleFaculty()},computed:{isrevise:function(){return"修改课程"==this.$route.meta.title?(this.getdata(),!0):(this.formData={time_site:[{}]},!1)}},watch:{faculty:function(t){this.handleMajor(t),this.major="",delete this.formData.grade},major:function(t){this.handleGrade(t),delete this.formData.grade}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{staticClass:"mb30",attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/layout/home"}}},[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/layout/courseList"}}},[t._v("课程列表页")]),t._v(" "),t.isrevise?a("el-breadcrumb-item",[t._v("修改课程")]):a("el-breadcrumb-item",[t._v("添加课程")])],1),t._v(" "),a("el-card",[a("el-form",{ref:"ref",staticClass:"table-ys",staticStyle:{width:"500px"},attrs:{model:t.formData,"label-width":"80px","label-position":"left"}},[this.teacherInfo?a("el-form-item",{attrs:{label:"任课教师",required:""}},[a("el-input",{attrs:{disabled:""},model:{value:this.teacherInfo.username,callback:function(e){t.$set(this.teacherInfo,"username",e)},expression:"this.teacherInfo.username"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"选择科目",required:""}},[a("el-select",{model:{value:t.formData.course_name,callback:function(e){t.$set(t.formData,"course_name",e)},expression:"formData.course_name"}},t._l(t.subjectCatalog,function(t){return a("el-option",{key:t._id,attrs:{label:t.subjectName,value:t._id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"院系"}},[a("el-select",{model:{value:t.faculty,callback:function(e){t.faculty=e},expression:"faculty"}},t._l(t.facultyCatalog,function(t){return a("el-option",{key:t._id,attrs:{label:t.facultyName,value:t._id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"专业"}},[a("el-select",{attrs:{placeholder:"请先选择一个院系"},model:{value:t.major,callback:function(e){t.major=e},expression:"major"}},t._l(t.majorCatalog,function(t){return a("el-option",{key:t._id,attrs:{label:t.majorName,value:t._id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"班级",required:""}},[a("el-select",{attrs:{placeholder:"请先选择一个专业"},model:{value:t.formData.grade,callback:function(e){t.$set(t.formData,"grade",e)},expression:"formData.grade"}},t._l(t.gradeCatalog,function(t){return a("el-option",{key:t._id,attrs:{label:t.gradeName,value:t._id}})}))],1),t._v(" "),a("hr",{staticClass:"line"}),t._v(" "),t._l(this.formData.time_site,function(e,o){return a("div",{key:o},[a("el-form-item",{attrs:{label:"上课时间",required:""}},[a("el-select",{attrs:{placeholder:"请选择周几上课"},model:{value:e.day,callback:function(a){t.$set(e,"day",a)},expression:"item.day"}},t._l([1,2,3,4,5,6,7],function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})})),t._v(" "),a("el-select",{attrs:{placeholder:"请选择第几节上课"},model:{value:e.node,callback:function(a){t.$set(e,"node",a)},expression:"item.node"}},t._l([1,2,3,4,5],function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"上课地点",required:""}},[a("el-input",{model:{value:e.classroom,callback:function(a){t.$set(e,"classroom",a)},expression:"item.classroom"}})],1)],1)}),t._v(" "),a("el-form-item",[t.isrevise?a("el-button",{attrs:{type:"primary"},on:{click:t.handlerevise}},[t._v("立即修改")]):a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("立即创建")]),t._v(" "),a("el-button",{on:{click:t.handelAddTime}},[t._v("再次添加上课时间和地点")]),t._v(" "),a("el-button",{on:{click:function(e){t.$router.push("/layout/facultyList")}}},[t._v("取消")])],1)],2)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(o,r,!1,function(t){a("m9O0")},"data-v-04c6cbf4",null);e.default=s.exports},m9O0:function(t,e){}});
//# sourceMappingURL=19.88db399bbd89d855f1e8.js.map